<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>FusionCharts v3 Documentation</title>
<link rel="stylesheet" type="text/css" href="../Style.css">
</head>

<body>
<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
  <tr> 
    <td><h2 class="pageHeader">FusionCharts ASP Class API &gt; Creating Combination Chart </h2></td>
  </tr>
  

  <tr>
    <td valign="top" class="text"><p>Combination chart has two Y-axis. The Y-axis on the left  hand side is called Primary Y-Axis and that on the right hand side is called  Secondary Y-Axis. Combination charts are used when we intend to compare two  different types of data on the same chart, e.g., if we want to plot Weekly  Sales Revenue of two consecutive months and total units sold on the same chart,  we have to use a Combination Chart. See the image below and note that the two Y-axis are representing different data units. </p></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text"><img src="../Images/ClassImages/ClassCombination.jpg" width="436" height="348" class="imageBorder" /></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">Let's add some more data to the existing Table for Multi-series chart. We would add a column that tabulates Total Qunatity Sales. </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">
      <table width="457" cellspacing="0" cellpadding="5" class="text" style="border:1px solid #cccccc;">
        <tr >
          <td width="25%" height="24" class="borderBottom"><strong>Week</strong></td>
          <td width="35%"  class="borderBottom">
            <div align="right"><strong>Current Month </strong></div>          </td>
          <td width="40%" class="borderBottom">
            <div align="right"><strong>Previous Month </strong></div>          </td>
          <td width="40%" align="right" class="borderBottom">&nbsp;</td>
        </tr>
        <tr>
          <td height="22" class="borderBottom">&nbsp;</td>
          <td class="borderBottom">
            <div align="right"><strong>Sales </strong></div>          </td>
          <td class="borderBottom">
            <div align="right"><strong>Sales </strong></div>          </td>
          <td align="right" class="borderBottom"><strong>Total Quantity </strong></td>
        </tr>
        <tr>
          <td height="25" class="borderBottom">Week 1 </td>
          <td class="borderBottom">
            <div align="right">$40800</div>          </td>
          <td class="borderBottom">
            <div align="right">$38300</div>          </td>
          <td align="right" class="borderBottom">64</td>
        </tr>
        <tr>
          <td height="25" class="borderBottom">Week 2 </td>
          <td class="borderBottom">
            <div align="right">$31400</div>          </td>
          <td class="borderBottom">
            <div align="right">$28400</div>          </td>
          <td align="right" class="borderBottom">70</td>
        </tr>
        <tr>
          <td height="25" class="borderBottom">Week 3 </td>
          <td class="borderBottom">
            <div align="right">$26700</div>          </td>
          <td class="borderBottom">
            <div align="right">$15700</div>          </td>
          <td align="right" class="borderBottom">52</td>
        </tr>
        <tr>
          <td height="25">Week 4 </td>
          <td>
            <div align="right">$54400</div>          </td>
          <td>
            <div align="right">$48100</div>          </td>
          <td align="right">81</td>
        </tr>
      </table>    </td>
  </tr>
  <tr>
     <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
     <td valign="top" class="highlightBlock"><strong>Before you go further with this page, we recommend you to please see   the previous pages &quot;Creating First Chart &quot; &amp; &quot;Creating Multi-series chart&quot;  as we start off from concepts explained in   that page. </strong></td>
  </tr>
  <tr>
     <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>Here is the code that builds up this Combination chart:</p></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="codeBlock"><p>&lt;%@LANGUAGE=&quot;VBSCRIPT&quot;%&gt;<br />
      &lt;%<br />
      <span class="codeComment">' Include FusionCharts ASP Class</span><br />
%&gt; <br />
&lt;!--#include file=&quot;../Class/FusionCharts_Gen.asp&quot;--&gt;<br />
&lt;%<br />
<br />
&nbsp;&nbsp;&nbsp;
dim FC<br />
<br />
<span class="codeComment">&nbsp;&nbsp;&nbsp; ' Create FusionCharts ASP class object </span><br />
&nbsp;&nbsp;&nbsp;
set FC = new FusionCharts<br />
<br />
<span class="codeComment">&nbsp;&nbsp;&nbsp; ' Set chart type to Column 3D + Line Dual Y-Axis Combination Chart</span><br />
&nbsp;&nbsp;&nbsp;
Call FC.setChartType(&quot;MSColumn3DLineDY&quot;)<br />
<br />
<span class="codeComment">&nbsp;&nbsp;&nbsp; ' Set chart size</span><br />
&nbsp;&nbsp;&nbsp;
Call FC.setSize(&quot;450&quot;,&quot;350&quot;)<br />
<br />
<span class="codeComment">&nbsp;&nbsp;&nbsp; ' Set the relative path of the swf file</span><br />
&nbsp;&nbsp;&nbsp;
Call FC.setSWFPath(&quot;../FusionCharts/&quot;)</p>
      <p> &nbsp;&nbsp;&nbsp; dim strParam<br />
        <br />
        <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Define chart attributes</span><br />
       &nbsp;&nbsp;&nbsp; strParam=&quot;caption=Weekly Sales;subcaption=Comparison;xAxisName=Week;<strong>pYAxisName=Revenue;sYAxisName=Total Quantity</strong>;numberPrefix=$;<strong>sNumberSuffix= U</strong>&quot;</p>
      <p> <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Set chart attributes</span><br />
     &nbsp;&nbsp;&nbsp; Call FC.setChartParams(strParam)</p>
      <p> <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Add category names</span><br />
       &nbsp;&nbsp;&nbsp; Call FC.addCategory(&quot;Week 1&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addCategory(&quot;Week 2&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addCategory(&quot;Week 3&quot;, &quot;&quot;, &quot;&quot;)<br />
     &nbsp;&nbsp;&nbsp; Call FC.addCategory(&quot;Week 4&quot;, &quot;&quot;, &quot;&quot;)</p>
      <p> <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Add a new dataset with dataset parameters </span><br />
       &nbsp;&nbsp;&nbsp; Call FC.addDataset(&quot;This Month&quot;,&quot;showValues=0&quot;)<br />
       <br />
        <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Add chart data for the above dataset</span><br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;40800&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;31400&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;26700&quot;, &quot;&quot;, &quot;&quot;)<br />
     &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;54400&quot;, &quot;&quot;, &quot;&quot;)</p>
      <p> <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Add another dataset with dataset parameters </span><br />
       &nbsp;&nbsp;&nbsp; Call FC.addDataset(&quot;Previous Month&quot;,&quot;showValues=0&quot;)<br />
       <br />
        <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Add chart data for the second dataset</span><br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;38300&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;28400&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;15700&quot;, &quot;&quot;, &quot;&quot;)<br />
     &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;48100&quot;, &quot;&quot;, &quot;&quot;)</p>
      <p> <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Add third dataset for the secondary axis</span><br />
       &nbsp;&nbsp;&nbsp; Call FC.addDataset(&quot;Total Quantity&quot;,&quot;<strong>parentYAxis=S</strong>&quot;)<br />
       <br />
        <span class="codeComment">&nbsp;&nbsp;&nbsp; ' Add  data values</span> <span class="codeComment">for the secondary axis</span> <br />
        &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;64&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;70&quot;, &quot;&quot;, &quot;&quot;)<br />
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;52&quot;, &quot;&quot;, &quot;&quot;)<br />
     &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;81&quot;, &quot;&quot;, &quot;&quot;)</p>
      <p>%&gt;<br />
      </p>
      <p>&lt;html&gt;<br />
  &nbsp;&nbsp;&nbsp; &lt;head&gt;<br />
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;title&gt;Column 3D + Line Dual Y-Axis Combination Chart Using FusionCharts ASP Class&lt;/title&gt;<br />
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;script language='javascript' src='../FusionCharts/FusionCharts.js'&gt;&lt;/script&gt;<br />
  &nbsp;&nbsp;&nbsp; &lt;/head&gt;<br />
  &nbsp;&nbsp;&nbsp; &lt;body&gt;</p>
      <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;%<br />
        <span class="codeComment">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Render Chart with JS embedding Method</span><br />
       &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Call FC.renderChart(false)<br />
       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %&gt;</p>
      <p> &nbsp;&nbsp;&nbsp; &lt;/body&gt;<br />
        &lt;/html&gt;</p>      </td>
  </tr>
  
  <tr>
     <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>As you  can see in the above code, the process of creating Combination charts  Multi-Series charts is same. Here also we use multiple datasets. Some datasets are specified for primary Y-Axis and some for the secondary Y-Axis.&nbsp; We need to specify which dataset belongs to which Y-Axis. Let's see what we have done to render a combination chart. The steps are mentioned below.</p>
      <ul type="disc">
        <li>We include <span class="codeInline">FusionCharts_Gen.asp</span>.<br />
           <br />
        </li>
        <li>We create       Multiseries Column 3D - Line Combination chart object and set relative path to swf file.<br />
              <br />
                 <span class="codeInline"> set FC = new FusionCharts<br />
Call FC.setChartType(&quot;MSColumn3DLineDY&quot;)<br/>
Call FC.setChartSize(&quot;450&quot;,&quot;350&quot;) <br />
                 Call FC-&gt;setSWFPath(&quot;../FusionCharts/&quot;)<br />
                 </span><br />
        </li>
        <li>Next, we store       chart attributes in <span class="codeInline">strParam</span> variable :<br /> 
           <br />
          <span class="codeInline">strParam=&quot;caption=Weekly Sales;subcaption=Comparison;xAxisName=Week;<strong>pYAxisName=Revenue</strong>;<strong>sYAxisName=Total Quantity</strong>;numberPrefix=$;<strong>sNumberSuffix= U</strong>&quot;;</span><br />
          <br />
          Combination charts have 2 Y-axis -Parent (p) and Secondary (s). So we have specified names for both of them. Moreover, using <span class="codeInline">sNumberSuffix</span>, we set the number suffix for secondary Y Axis. <br />
          <br />
        </li>
        <li>We set these chart attributes calling <span class="codeInline">setChartParams()</span><br />
           <br /> 
           <span class="codeInline">Call FC.setChartParams(strParam)</span><br />
           <br />
        </li>
        <li>Next, like in Multi-series charts, we add categories :<br />
           <br />
            <span class="codeInline">Call FC.addCategory(&quot;Week 1&quot;,&quot;&quot;,&quot;&quot;)<br />
              Call FC.addCategory(&quot;Week 2&quot;,&quot;&quot;,&quot;&quot;)<br />
              Call FC.addCategory(&quot;Week 3&quot;,&quot;&quot;,&quot;&quot;)<br />
            Call FC.addCategory(&quot;Week 4&quot;,&quot;&quot;,&quot;&quot;)</span><br />
            <br />
        </li>
        <li>We add       the first dataset 'This Month' for primary Y-Axis. If we do not specify the Y-Axis the dataset adheres to, the chart automatically sets it to primary Y-Axis. <br />
           <br />
            <span class="codeInline">Call FC.addDataset(&quot;This Month&quot;,&quot;<strong>showValues=0</strong>&quot;);<br />
            Call FC.addChartData(&quot;40800&quot;,&quot;&quot;,&quot;&quot;)<br />
Call FC.addChartData(&quot;31400&quot;,&quot;&quot;,&quot;&quot;)<br />
Call FC.addChartData(&quot;26700&quot;,&quot;&quot;,&quot;&quot;)<br />
Call FC.addChartData(&quot;54400&quot;,&quot;&quot;,&quot;&quot;)</span><br />
          <br />
        </li>
        <li>Again, we add another dataset 'Previous Month' for primary Y-Axis and set its attributes and  data values.<br /> 
           <br />
            <span class="codeInline">Call FC.addDataset(&quot;Previous Month&quot;,&quot;showValues=0&quot;)<br />
              Call FC.addChartData(&quot;38300&quot;,&quot;&quot;,&quot;&quot;)<br />
              Call FC.addChartData(&quot;28400&quot;,&quot;&quot;,&quot;&quot;)<br />
              Call FC.addChartData(&quot;15700&quot;,&quot;&quot;,&quot;&quot;)<br />
            Call FC.addChartData(&quot;48100&quot;,&quot;&quot;,&quot;&quot;)</span><br />
            <br />
        </li>
        <li>Now, we add the third dataset, this one for Secondary Y-axis and its data values. Here, we specify the Y-Axis by passing the dataset attribute <span class="codeInline">parentYAxis=S</span>. <br />
           <br />
          <span class="codeInline">Call FC.addDataset(&quot;Total Quantity&quot;,&quot;<strong>parentYaxis=S</strong>&quot;) <br />
          Call FC.addChartData(&quot;64&quot;,&quot;&quot;,&quot;&quot;)<br />
          Call FC.addChartData(&quot;70&quot;,&quot;&quot;,&quot;&quot;)<br />
          Call FC.addChartData(&quot;52&quot;,&quot;&quot;,&quot;&quot;)<br />
        Call FC.addChartData(&quot;81&quot;,&quot;&quot;,&quot;&quot;)</span><br />
        <br />
        </li>
        <li>Finally, we add <span class="codeInline">FusionCharts.js</span> and <br />
           <br />
        </li>
        <li> render the chart : <br />
           <br />
            <span class="codeInline">Call FC.renderChart(false)</span></li>
    </ul></td>
  </tr>
  <tr>
     <td valign="top">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="highlightBlock">Please go through <a href="Functions.html">FusionCharts ASP Class API Reference</a> section to know more about the functions used in the above code. </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">This code renders the Combination Chart that we needed. </td>
  </tr>
  
  <tr>
    <td valign="top" class="text"><img src="../Images/ClassImages/ClassCombination.jpg" width="436" height="348" class="imageBorder" /></td>
  </tr>
  
  <tr> 
    <td valign="top" class="text">&nbsp;</td>
  </tr>
</table>
</body>
</html>
